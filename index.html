<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Chủ - NutriPlan - Thực Đơn Sống Khỏe</title>
   
   
    <!-- Firebase SDK -->
     <!--firebase App (cho mọi ứng dụng firebase )-->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <!--firebase Auth (Xác thực người dùng)-->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <!--firebase Database (Lưu trữ dữ liệu)-->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&family=League+Spartan:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Montserrat:wght@400;700&family=Dancing+Script:wght@400;700&family=Segoe+UI:wght@400;700&display=swap" rel="stylesheet">
    <!-- Thêm Swiper CSS và JS vào head -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <style>
        @font-face {
            font-family: 'SEGO';
            src: url('font/SEGO.otf') format('opentype');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'SVN-Taken by Vultures';
            src: url('SVN-Taken by Vultures.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        :root {
            --primary-color: #097770;
            --secondary-color: #ffb82e;
            --text-color: #1E1E1E;
            --bg-color: #f8f9fa;
            --white: #FFFFFF;
            --shadow: 0 4px 24px rgba(0,0,0,0.10);
            --transition: all 0.3s cubic-bezier(.4,0,.2,1);
            --swiper-theme-color: #07a044;
            --swiper-navigation-size: 44px;
            --mauNenKhung: #fff0f0;
            --mauChuDanhSachSanPham: #212b35;
            --mauNenLabel: #ffe5e5;
            --mauChuLabel: #ff4d4d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Playfair Display', serif;
            color: var(--text-color);
            line-height: 1.7;
            background-color: var(--bg-color);
        }

        /* Header Styles */
        header {
            background-color: #FFE5B4;
            padding: 20px 0;
            text-align: center;
        }

        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        #logo-img {
            width: 105px;
            height: 105px;
            margin-bottom: -20px;
            background-color: var(--white);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            position: relative;
            z-index: 1;
        }

        .site-title {
            font-family: 'SEGO', sans-serif;
            font-size: 2.8em;
            font-weight: bold;
            color: #000000;
            margin-bottom: 0;
            position: relative;
            z-index: 2;
        }

        .tagline {
            font-family: 'SVN-Taken by Vultures', sans-serif;
            font-size: 3.0em;
            color: #000000;
            margin-top: -5px;
            margin-bottom: 15px;
        }

        /* Navigation Styles */
        nav {
            background-color: var(--primary-color);
            padding: 0.8rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1.5rem;
        }

        .nav-menu {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 0;
            padding: 0;
        }

        .nav-menu li a {
            color: var(--white);
            text-decoration: none;
            font-size: 0.95em;
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 4px;
            transition: var(--transition);
            white-space: nowrap;
        }

        .nav-menu li a:hover {
            background-color: var(--secondary-color);
            color: var(--primary-color);
        }

        .nav-login {
            display: flex;
            align-items: center;
            gap: 1rem;
            min-width: 200px;
        }

        .login-btn {
            background: var(--secondary-color);
            color: var(--primary-color);
            font-weight: bold;
            border-radius: 20px;
            padding: 8px 20px;
            border: none;
            font-size: 1em;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
        }

        .login-btn .user-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .login-btn span {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .login-btn:hover {
            background: #FFA726;
            color: #fff;
            transform: translateY(-2px) scale(1.04);
        }

        /* Main Content Styles */
        main {
            padding: 25px;
            max-width: 1200px;
            margin: 30px auto;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        /* Hero Slider Styles */
        .hero-slider {
            position: relative;
            width: 100%;
            height: 600px;
            overflow: hidden;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .hero-slides {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .hero-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .hero-slide.active {
            opacity: 1;
        }

        .hero-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.7);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            color: #333;
            transition: var(--transition);
        }

        .hero-nav:hover {
            background: rgba(255, 255, 255, 0.9);
        }

        .hero-nav-left { left: 24px; }
        .hero-nav-right { right: 24px; }

        /* CTA Button Styles */
        .hero-cta {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .cta-button {
            display: inline-block;
            background-color: var(--secondary-color);
            color: var(--text-color);
            padding: 14px 30px;
            text-decoration: none;
            border-radius: 25px;
            font-size: 1.15em;
            font-weight: bold;
            transition: var(--transition);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .cta-button:hover {
            background-color: #FFA726;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        /* Features Section Styles */
        #features {
            text-align: center;
            padding: 2.5rem 0;
        }

        #features h2 {
            font-size: 2.2em;
            margin-bottom: 2rem;
            color: var(--primary-color);
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2.5rem;
            margin-top: 1rem;
        }

        .feature-item {
            background-color: var(--white);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
        }

        .feature-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.12);
        }

        .feature-item img {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .feature-item h3 {
            font-size: 1.6em;
            margin-bottom: 0.6em;
            color: #4A7F53;
        }

        /* Recipes Section Styles */
        .recipes-section {
            padding: 3rem 0;
            margin: 2.5rem 0;
            background-color: var(--bg-color);
        }

        .recipes-section h2 {
            text-align: center;
            font-size: 2.2em;
            margin-bottom: 2rem;
            color: var(--primary-color);
            font-family: 'Lexend', sans-serif;
            font-weight: 600;
        }

        .recipes-container {
            position: relative;
            padding: 0 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .recipes-slider {
            position: relative;
            padding: 40px 0 60px 0;
            overflow: hidden !important;
        }

        .recipes-slider .swiper-wrapper {
            overflow: visible; /* hoặc bỏ dòng này đi */
        }

        .recipes-slider .swiper-slide {
            width: auto; /* hoặc bỏ width cứng */
            margin-right: 24px;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: stretch;
        }

        .recipe-card {
            background: var(--white);
            border-radius: 32px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 100%;
            border: 1px solid rgba(0,0,0,0.04);
            display: flex;
            flex-direction: column;
            min-height: 420px;
        }

        .recipe-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 12px 36px rgba(0,0,0,0.16);
        }

        .recipe-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .recipe-card:hover img {
            transform: scale(1.08);
        }

        .recipe-content {
            padding: 1.5rem;
            background: var(--white);
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .recipe-info {
            display: flex;
            justify-content: space-between;
            margin: 0.5rem 0;
            font-size: 0.9rem;
            color: #666;
        }

        .recipe-nutrition {
            display: flex;
            gap: 1rem;
            margin: 0.5rem 0;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .nutrition-item {
            text-align: center;
            flex: 1;
        }

        .nutrition-value {
            font-weight: bold;
            color: var(--primary-color);
        }

        .nutrition-label {
            font-size: 0.8rem;
            color: #666;
        }

        .recipe-description {
            margin: 0.5rem 0;
            font-size: 0.9rem;
            color: #444;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .recipe-link {
            margin-top: auto;
            text-align: center;
        }

        /* Swiper Navigation Buttons */
        .recipes-slider .swiper-button-next,
        .recipes-slider .swiper-button-prev {
            width: 48px;
            height: 48px;
            background: var(--white);
            border-radius: 50%;
            color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.10);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            transition: var(--transition);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .recipes-slider .swiper-button-next {
            right: 8px;
            left: auto;
        }
        .recipes-slider .swiper-button-prev {
            left: 8px;
            right: auto;
        }
        .recipes-slider .swiper-button-next:after,
        .recipes-slider .swiper-button-prev:after {
            font-size: 22px;
            font-weight: bold;
        }
        .recipes-slider .swiper-button-next:hover,
        .recipes-slider .swiper-button-prev:hover {
            background: var(--secondary-color);
            color: var(--white);
            transform: translateY(-50%) scale(1.08);
        }

        /* Swiper Pagination */
        .recipes-slider .swiper-pagination {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 10px;
            margin: 0 auto;
            position: relative;
            margin-top: 20px;
        }

        .recipes-slider .swiper-pagination-bullet {
            width: 10px;
            height: 10px;
            background: var(--primary-color);
            opacity: 0.5;
        }

        .recipes-slider .swiper-pagination-bullet-active {
            opacity: 1;
            background: var(--primary-color);
        }

        @media (max-width: 768px) {
            .recipes-slider .swiper-slide {
                width: 250px;
            }
            
            .recipes-section h2 {
                font-size: 1.8em;
            }
            
            .recipe-content h3 {
                font-size: 1.2em;
            }
        }

        /* About Section Styles */
        #about {
            background-color: #F1F8E9;
            padding: 2.5rem;
            border-radius: 8px;
            margin-top: 2.5rem;
        }

        #about h2 {
            text-align: center;
            font-size: 2.2em;
            margin-bottom: 2rem;
            color: var(--primary-color);
        }

        /* Contact Section Styles */
        .contact-section {
            padding: 2.5rem 0;
            background-color: #F1F8E9;
            border-radius: 8px;
            margin-top: 2.5rem;
        }

        .contact-title {
            text-align: center;
            margin-bottom: 2rem;
        }

        .contact-title h2 {
            font-size: 2.2em;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .contact-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .contact-info {
            background: var(--white);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .contact-details {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .contact-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            border-radius: 8px;
            transition: var(--transition);
        }

        .contact-item:hover {
            background-color: #F1F8E9;
        }

        .contact-item svg {
            width: 24px;
            height: 24px;
            color: var(--primary-color);
            flex-shrink: 0;
        }

        .contact-item h3 {
            font-size: 1.2em;
            margin-bottom: 0.5rem;
            color: #2E7D32;
        }

        .contact-item a {
            color: var(--primary-color);
            text-decoration: none;
            transition: var(--transition);
        }

        .contact-item a:hover {
            color: #2E7D32;
        }

        .contact-form {
            background: var(--white);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-group textarea {
            height: 150px;
            resize: vertical;
        }

        .submit-btn {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 1rem 2rem;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .submit-btn:hover {
            background-color: #2E7D32;
        }

        /* Footer Styles */
        .main-footer {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 3rem 0 0;
            margin-top: 3rem;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }

        .footer-col {
            padding: 0 1rem;
        }

        .footer-col h4 {
            font-size: 1.2em;
            margin-bottom: 1.5rem;
            color: var(--secondary-color);
        }

        .footer-col ul {
            list-style: none;
        }

        .footer-col ul li {
            margin-bottom: 0.8rem;
        }

        .footer-col ul li a {
            color: var(--white);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-col ul li a:hover {
            color: var(--secondary-color);
        }

        .footer-logo {
            width: 80px;
            height: 80px;
            margin-bottom: 1rem;
        }

        .footer-brand {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .footer-slogan {
            font-size: 1.2em;
            margin-bottom: 1rem;
            color: var(--secondary-color);
        }

        .footer-desc {
            color: #ddd;
            line-height: 1.6;
        }

        .footer-social {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .footer-social a {
            color: var(--white);
            transition: var(--transition);
        }

        .footer-social a:hover {
            color: var(--secondary-color);
        }

        .footer-contact {
            margin-top: 1.5rem;
        }

        .footer-contact-row {
            margin-bottom: 0.8rem;
        }

        .footer-contact-label {
            font-weight: bold;
            color: var(--secondary-color);
            margin-right: 0.5rem;
        }

        .footer-contact-content {
            color: #ddd;
        }

        .footer-bottom {
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        /* Updated Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--white);
            padding: 0;
            border-radius: 16px;
            width: 90%;
            max-width: 360px;
            position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary-color), #2E7D32);
            color: white;
            text-align: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.3rem;
            color: white;
            font-weight: 600;
        }

        .modal-body {
            padding: 1.2rem;
        }

        .close {
            position: absolute;
            right: 0.8rem;
            top: 0.8rem;
            font-size: 1.2rem;
            cursor: pointer;
            color: white;
            z-index: 1;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.2rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 0.6rem;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 0.4rem 0.8rem;
            cursor: pointer;
            font-size: 0.95rem;
            color: #666;
            position: relative;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }

        .tab-btn.active {
            color: var(--primary-color);
            font-weight: 600;
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -0.6rem;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary-color);
        }

        .social-login {
            margin-bottom: 1.2rem;
        }

        .social-login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .social-login-btn:hover {
            background: #f5f5f5;
            border-color: #ccc;
        }

        .social-login-btn img {
            width: 18px;
            height: 18px;
        }

        .divider {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 1rem 0;
            color: #666;
            font-size: 0.85rem;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #ddd;
        }

        .divider span {
            padding: 0 0.6rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.3rem;
            color: #333;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-group input {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(58, 125, 68, 0.1);
        }

        .submit-btn {
            width: 100%;
            background-color: var(--primary-color);
            color: white;
            padding: 0.7rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 0.5rem;
        }

        .submit-btn:hover {
            background-color: #2E7D32;
            transform: translateY(-1px);
        }

        .forgot-password {
            display: block;
            text-align: center;
            color: var(--primary-color);
            text-decoration: none;
            font-size: 0.8rem;
            margin-top: 0.6rem;
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .terms-checkbox {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            margin: 0.8rem 0;
            font-size: 0.8rem;
            color: #666;
        }

        .terms-checkbox input[type="checkbox"] {
            width: 14px;
            height: 14px;
        }

        .terms-checkbox a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .terms-checkbox a:hover {
            text-decoration: underline;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 480px) {
            .modal-content {
                width: 95%;
                margin: 0;
            }

            .modal-body {
                padding: 1rem;
            }

            .modal-header h2 {
                font-size: 1.2rem;
            }
        }

        /* User Dropdown Styles */
        .user-dropdown {
            position: relative;
            display: inline-block;
        }

        .user-dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-radius: 8px;
            z-index: 1000;
            margin-top: 0.5rem;
            animation: dropdownFadeIn 0.2s ease;
        }

        @keyframes dropdownFadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-dropdown-content a {
            color: #333;
            padding: 0.8rem 1rem;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .user-dropdown-content a:hover {
            background-color: #f5f5f5;
        }

        .user-dropdown-content a:first-child {
            border-radius: 8px 8px 0 0;
        }

        .user-dropdown-content a:last-child {
            border-radius: 0 0 8px 8px;
            color: #dc3545;
        }

        .user-dropdown-content a svg {
            width: 18px;
            height: 18px;
        }

        .user-dropdown-content a:last-child svg {
            color: #dc3545;
        }

        .user-dropdown.show .user-dropdown-content {
            display: block;
        }

        .user-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .login-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
    </style>

    <!-- Thêm font Lexend -->
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="header-content">
            <img src="picture/NutriPlan.png" alt="NutriPlan Logo" id="logo-img"> 
            <div class="site-title">NutriPlan</div>
            <div class="tagline">Thực Đơn Sống Khỏe</div>
        </div>
    </header>


    
    <nav>
        <div class="nav-container">
            <ul class="nav-menu">
            <li><a href="index.html">Trang Chủ</a></li>
            <li><a href="calculator.html">Tính CALO & TDEE & BMR</a></li>
            <li><a href="FoodandRecipes.html">Món Ăn & Công Thức</a></li>
            <li><a href="about.html">Giới Thiệu</a></li>
            <li><a href="contact.html">Liên Hệ</a></li>
            <li><a href="terms.html">Điều khoản & Bảo mật</a></li>
        </ul>
            <div class="nav-login">
                <div class="user-dropdown">
                    <a href="#" id="loginBtn" class="login-btn">Đăng Nhập</a>
                    <div class="user-dropdown-content">
                        <a href="account.html">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                            Tài khoản
                        </a>
                        <a href="#" id="logoutBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                            Đăng xuất
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main>
        <section class="hero-slider">
            <div class="hero-slides">
                <div class="hero-slide active" style="background-image: url('picture/dinhduongthongminh.png');"></div>
                <div class="hero-slide" style="background-image: url('picture/thucdoncanhan.png');"></div>
            </div>
            <button class="hero-nav hero-nav-left" aria-label="Trước">&#10094;</button>
            <button class="hero-nav hero-nav-right" aria-label="Sau">&#10095;</button>
        </section>

        <div class="hero-cta">
            <a href="calculator.html" class="cta-button">Bắt Đầu Ngay</a>
        </div>

        <section id="features">
            <h2>Tính Năng Nổi Bật</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <img src="picture/tinh-calo.jpeg" alt="Tính Calo Chính Xác">
                    <h3>Tính Calo Chính Xác</h3>
                    <p>Dựa trên thông tin cá nhân, chúng tôi sẽ giúp bạn xác định lượng calo cần thiết mỗi ngày.</p>
                </div>
                <div class="feature-item">
                    <img src="picture/thuc-don-da-dang.jpg" alt="Gợi Ý Thực Đơn Đa Dạng">
                    <h3>Gợi Ý Thực Đơn Đa Dạng</h3>
                    <p>Thực đơn phong phú, phù hợp với mục tiêu: giảm cân, tăng cơ, ăn chay, healthy...</p>
                </div>
                <div class="feature-item">
                    <img src="picture/theo-sat-suc-khoe.jpg" alt="Theo Sát Sức Khỏe">
                    <h3>Theo Sát Sức Khỏe</h3>
                    <p>Các gợi ý được điều chỉnh theo tình trạng sức khỏe như thiếu máu, nóng trong người.</p>
                </div>
            </div>
        </section>

        <section id="recipes" class="recipes-section">
            <h2>Công Thức Nấu Ăn</h2>
            <div class="recipes-container">
                <div class="recipes-slider swiper">
                    <div class="swiper-wrapper" id="recipesContainer">
                        <!-- Recipes will be dynamically added here -->
                    </div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
        </section>

        <section id="about">
            <h2>Giới Thiệu</h2>
            <p><br>NutriPlan là một website tư vấn thực đơn dinh dưỡng, hỗ trợ người dùng lựa chọn món ăn phù hợp với tình trạng sức khỏe và mục tiêu cá nhân. Thay vì ăn theo cảm tính, người dùng có thể tra cứu thực đơn dựa trên các nhóm nhu cầu như giảm cân, tăng cơ, ăn chay hoặc sống lành mạnh.<br>

               <br> Một tính năng nổi bật của NutriPlan là "Tính lượng Calo cần thiết" – hệ thống cho phép người dùng nhập các thông tin cơ bản như tuổi, giới tính, chiều cao, cân nặng và mức độ vận động, từ đó tính toán lượng Calo
               
                cần nạp mỗi ngày theo công thức TDEE hoặc BMR. Việc này giúp người dùng kiểm soát năng lượng đầu vào và điều chỉnh chế độ ăn uống phù hợp hơn với mục tiêu của mình.NutriPlan là người bạn đồng hành đáng tin cậy trong hành trình chăm sóc sức khỏe qua từng bữa ăn hằng ngày.<br>
Chúng tôi hỗ trợ bạn lựa chọn món ăn phù hợp với tình trạng sức khỏe và mục tiêu dinh dưỡng cá nhân, từ đó giúp bạn hiểu cơ thể mình hơn và ăn uống đúng cách.<br><br>
Chúng tôi tin rằng một chế độ ăn khoa học không cần cầu kỳ, chỉ cần đúng với nhu cầu của bạn.<br>
Dù bạn muốn giảm cân, tăng cơ, thanh lọc cơ thể hay đơn giản là sống lành mạnh hơn – NutriPlan luôn sẵn sàng gợi ý món ăn phù hợp để bạn bắt đầu ngày mới một cách nhẹ nhàng và tràn đầy năng lượng.<br><br>
Lưu ý: NutriPlan là nền tảng hỗ trợ người dùng lựa chọn thực đơn phù hợp với tình trạng cơ thể và mục tiêu dinh dưỡng cá nhân.
NutriPlan không phải là website bán hàng, không thực hiện giao dịch thương mại hay đặt hàng. Chúng tôi không chịu trách nhiệm về bất kỳ thông tin bên ngoài nào không thuộc hệ thống này.</p>
        </section>

        <section id="contact" class="contact-section">
            <div class="contact-title">
                <h2>Liên Hệ Với Chúng Tôi</h2>
                <p>Bạn có câu hỏi hoặc cần tư vấn? Hãy để lại thông tin, chúng tôi sẽ liên hệ lại ngay!</p>
            </div>
            <div class="contact-container">
                <div class="contact-info">
                    <div class="contact-details">
                        <div class="contact-item">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                            <div>
                                <h3>Điện Thoại</h3>
                                <p><a href="tel:0888192049">0888 192 049</a></p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><polyline points="22,6 12,13 2,6"/></svg>
                            <div>
                                <h3>Email</h3>
                                <p><a href="mailto:nutriplan.@gmail.com">nutriplan@gmail.com</a></p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                            <div>
                                <h3>Địa Chỉ</h3>
                                <p>168 Nguyễn Văn Cừ nối dài, An Bình, Ninh Kiều, Cần Thơ</p>
                            </div>
                        </div>
                    </div>
                </div>
                <form class="contact-form" action="#" method="POST">
                    <div class="form-group">
                        <label for="name">Họ và tên</label>
                        <input type="text" id="name" name="name" required placeholder="Nhập họ và tên của bạn">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required placeholder="Nhập email của bạn">
                    </div>
                    <div class="form-group">
                        <label for="phone">Số điện thoại</label>
                        <input type="tel" id="phone" name="phone" placeholder="Nhập số điện thoại của bạn">
                    </div>
                    <div class="form-group">
                        <label for="subject">Chủ đề</label>
                        <select id="subject" name="subject" required>
                            <option value="">Chọn chủ đề</option>
                            <option value="tư-vấn">Tư vấn dinh dưỡng</option>
                            <option value="hợp-tác">Hợp tác</option>
                            <option value="góp-ý">Góp ý</option>
                            <option value="khác">Khác</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="message">Nội dung</label>
                        <textarea id="message" name="message" required placeholder="Nhập nội dung tin nhắn của bạn"></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Gửi Tin Nhắn</button>
                </form>
            </div>
        </section>
    </main>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-header">
                <h2>Chào mừng đến với NutriPlan</h2>
            </div>
            <div class="modal-body">
                <div class="modal-tabs">
                    <button class="tab-btn active" data-tab="login">Đăng Nhập</button>
                    <button class="tab-btn" data-tab="register">Đăng Ký</button>
                </div>
                
                <div id="login" class="tab-content active">
                    <div class="social-login">
                        <button class="social-login-btn" id="googleLogin">
                            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                            Đăng nhập với Google
                        </button>
                    </div>
                    <div class="divider">
                        <span>hoặc</span>
                    </div>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="loginEmail">Email</label>
                            <input type="email" id="loginEmail" required placeholder="Nhập email của bạn">
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Mật khẩu</label>
                            <input type="password" id="loginPassword" required placeholder="Nhập mật khẩu của bạn">
                        </div>
                        <button type="submit" class="submit-btn">Đăng Nhập</button>
                        <a href="#" class="forgot-password">Quên mật khẩu?</a>
                    </form>
                </div>

                <div id="register" class="tab-content">
                    <div class="social-login">
                        <button class="social-login-btn" id="googleRegister">
                            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                            Đăng ký với Google
                        </button>
                    </div>
                    <div class="divider">
                        <span>hoặc</span>
                    </div>
                    <form id="registerForm">
                        <div class="form-group">
                            <label for="registerName">Họ và tên</label>
                            <input type="text" id="registerName" required placeholder="Nhập họ và tên của bạn">
                        </div>
                        <div class="form-group">
                            <label for="registerEmail">Email</label>
                            <input type="email" id="registerEmail" required placeholder="Nhập email của bạn">
                        </div>
                        <div class="form-group">
                            <label for="registerPassword">Mật khẩu</label>
                            <input type="password" id="registerPassword" required placeholder="Nhập mật khẩu của bạn">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Xác nhận mật khẩu</label>
                            <input type="password" id="confirmPassword" required placeholder="Nhập lại mật khẩu">
                        </div>
                        <div class="terms-checkbox">
                            <input type="checkbox" id="terms" required>
                            <label for="terms">Tôi đồng ý với <a href="#">Điều khoản sử dụng</a> và <a href="#">Chính sách bảo mật</a></label>
                        </div>
                        <button type="submit" class="submit-btn">Đăng Ký</button>
                    </form>
                </div>

                <div id="forgotPassword" class="tab-content">
                    <h2 style="font-size: 1.3rem; margin-bottom: 1rem;">Quên Mật Khẩu</h2>
                    <p style="margin-bottom: 1.2rem; color: #666; font-size: 0.9rem;">Nhập email của bạn để nhận link đặt lại mật khẩu</p>
                    <form id="forgotPasswordForm">
                        <div class="form-group">
                            <label for="forgotEmail">Email</label>
                            <input type="email" id="forgotEmail" required placeholder="Nhập email của bạn">
                        </div>
                        <button type="submit" class="submit-btn">Gửi Link Đặt Lại Mật Khẩu</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-col about">
                <img src="picture/NutriPlan.png" alt="NutriPlan Logo" class="footer-logo">
                <div class="footer-brand">NutriPlan</div>
                <div class="footer-slogan">Thực Đơn Sống Khỏe</div>
                <p class="footer-desc">Đồng hành cùng bạn xây dựng thực đơn khoa học, sống khỏe mỗi ngày.</p>
            </div>
            <div class="footer-col">
                <h4>Về NutriPlan</h4>
                <ul>
                    <li><a href="index.html">Trang Chủ</a></li>
                    <li><a href="about.html">Giới Thiệu</a></li>
                    
                </ul>
            </div>
            <div class="footer-col">
                <h4>Sức Khỏe</h4>
                <ul>
                    <li><a href="calculator.html">Tính Calo & TDEE</a></li>
                    <li><a href="FoodandRecipes.html">Món Ăn & Công Thức</a></li>
                    <li><a href="account.html">Tài Khoản</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Hỗ Trợ</h4>
                <ul>
                    <li><a href="#contact">Liên Hệ</a></li>
                    <li><a href="terms.html">Chính Sách Bảo Mật</a></li>
                    <li><a href="terms.html">Điều Khoản Sử Dụng</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Kết Nối</h4>
                
                <div class="footer-contact">
                    <div class="footer-contact-row"><span class="footer-contact-label">Hotline:</span> <span class="footer-contact-content"><a href="tel:0888192049">0888 192 049</a></span></div>
                    <div class="footer-contact-row"><span class="footer-contact-label">Email:</span> <span class="footer-contact-content"><a class="footer-email" href="mailto:nutriplan@gmail.com">nutriplan@gmail.com</a></span></div>
                    <div class="footer-contact-row"><span class="footer-contact-label">Địa chỉ:</span> <span class="footer-contact-content">168 Nguyễn Văn Cừ nối dài,An Bình,Ninh Kiều,Cần Thơ</span></div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2024 NutriPlan. All rights reserved.
        </div>
    </footer>

    <script>


        // Firebase configuration (cấu hình firebase)
        const firebaseConfig = {
            apiKey: "AIzaSyDi1RRzsP4TtZ1R-o9Tst5UX1t1C0BI2pA",
            authDomain: "nutriplan-f335e.firebaseapp.com",
            databaseURL: "https://nutriplan-f335e-default-rtdb.firebaseio.com",
            projectId: "nutriplan-f335e",
            storageBucket: "nutriplan-f335e.firebasestorage.app",
            messagingSenderId: "594370805250",
            appId: "1:594370805250:web:4b54c8e3e88b152858b11b",
            measurementId: "G-5FT11ZN85P"
        };

        // Initialize Firebase (khởi tạo firebase)
        firebase.initializeApp(firebaseConfig);



        document.addEventListener('DOMContentLoaded', function() {
            // Hero slider functionality
            const slides = document.querySelectorAll('.hero-slide');
            const prevBtn = document.querySelector('.hero-nav-left');
            const nextBtn = document.querySelector('.hero-nav-right');
            let currentSlide = 0;
            let slideInterval;

            function showSlide(index) {
                slides.forEach(slide => slide.classList.remove('active'));
                slides[index].classList.add('active');
            }

            function nextSlide() {
                currentSlide = (currentSlide + 1) % slides.length;
                showSlide(currentSlide);
            }

            function prevSlide() {
                currentSlide = (currentSlide - 1 + slides.length) % slides.length;
                showSlide(currentSlide);
            }

            function startSlideShow() {
                slideInterval = setInterval(nextSlide, 5000);
            }

            function stopSlideShow() {
                clearInterval(slideInterval);
            }

            if (prevBtn && nextBtn) {
                prevBtn.addEventListener('click', () => {
                    prevSlide();
                    stopSlideShow();
                    startSlideShow();
                });
                nextBtn.addEventListener('click', () => {
                    nextSlide();
                    stopSlideShow();
                    startSlideShow();
                });
            }

            startSlideShow();

            // Form handling
            const contactForm = document.querySelector('.contact-form');
            if (contactForm) {
                // Auto-fill form when user is logged in
                firebase.auth().onAuthStateChanged(function(user) {
                    if (user) {
                        contactForm.querySelector('#name').value = user.displayName || '';
                        contactForm.querySelector('#email').value = user.email || '';
                    }
                });

                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const user = firebase.auth().currentUser;
                    if (!user) {
                        Swal.fire({ title: 'Lỗi!', text: 'Vui lòng đăng nhập để gửi liên hệ', icon: 'error' });
                        return;
                    }
                    const contactData = {
                        name: contactForm.querySelector('#name').value,
                        email: contactForm.querySelector('#email').value,
                        phone: contactForm.querySelector('#phone').value,
                        subject: contactForm.querySelector('#subject').value,
                        message: contactForm.querySelector('#message').value,
                        userId: user.uid,
                        createdAt: new Date().toISOString(),
                        status: 'pending'
                    };
                    Swal.fire({ title: 'Đang gửi...', text: 'Vui lòng đợi trong giây lát', allowOutsideClick: false, didOpen: () => { Swal.showLoading(); } });
                    firebase.database().ref('contacts').push(contactData)
                        .then(() => {
                            Swal.fire({ title: 'Thành công!', text: 'Tin nhắn của bạn đã được gửi. Chúng tôi sẽ liên hệ lại sớm nhất có thể.', icon: 'success', timer: 1800, showConfirmButton: false });
                            contactForm.reset();
                        })
                        .catch((error) => {
                            Swal.fire({ title: 'Lỗi!', text: 'Không thể gửi tin nhắn: ' + error.message, icon: 'error' });
                        });
                });
            }

            // Modal functionality
            const modal = document.getElementById('loginModal');
            const loginBtn = document.getElementById('loginBtn');
            const closeBtn = document.querySelector('.close');
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            const forgotPasswordLink = document.querySelector('.forgot-password');
            const userDropdown = document.querySelector('.user-dropdown');

            // Show modal
            loginBtn.addEventListener('click', function(e) {
                e.preventDefault();
                if (firebase.auth().currentUser) {
                    // If user is logged in, toggle dropdown
                    userDropdown.classList.toggle('show');
                } else {
                    // If user is not logged in, redirect to auth page
                    window.location.href = 'auth.html';
                }
            });

            // Close modal
            closeBtn.addEventListener('click', function() {
                modal.classList.remove('show');
            });

            // Close modal when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.classList.remove('show');
                }
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!userDropdown.contains(e.target)) {
                    userDropdown.classList.remove('show');
                }
            });

            // Tab switching
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab button
                    tabBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding content
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === tabId) {
                            content.classList.add('active');
                        }
                    });
                });
            });

            // Forgot password link
            forgotPasswordLink.addEventListener('click', function(e) {
                e.preventDefault();
                tabBtns.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById('forgotPassword').classList.add('active');
            });

            // Form submissions with validation
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;

                if (!email || !password) {
                    showErrorAlert('Lỗi!', 'Vui lòng điền đầy đủ thông tin');
                    return;
                }

                firebase.auth().signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        const user = userCredential.user;
                        // Kiểm tra nếu là admin
                        if (user.email === 'quantrinutriplan@gmail.com') {
                            window.location.href = 'admin.html';
                            return;
                        }
                        // Chỉ cập nhật thời gian đăng nhập cuối
                        return firebase.database().ref('users/' + user.uid).update({
                            lastLogin: new Date().toISOString()
                        }).then(() => {
                            showSuccessAlert('Thành công!', 'Đăng nhập thành công');
                            modal.classList.remove('show');
                            updateLoginState(user);
                        });
                    })
                    .catch((error) => {
                        showErrorAlert('Lỗi!', error.message);
                    });
            });

            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('registerEmail').value;
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const name = document.getElementById('registerName').value;
                const terms = document.getElementById('terms').checked;

                if (!email || !password || !confirmPassword || !name) {
                    Swal.fire({
                        title: 'Lỗi!',
                        text: 'Vui lòng điền đầy đủ thông tin',
                        icon: 'error'
                    });
                            return;
                        }

                if (password !== confirmPassword) {
                    Swal.fire({
                        title: 'Lỗi!',
                        text: 'Mật khẩu xác nhận không khớp',
                        icon: 'error'
                    });
                    return;
                }

                if (!terms) {
                    Swal.fire({
                        title: 'Lỗi!',
                        text: 'Vui lòng đồng ý với điều khoản sử dụng',
                        icon: 'error'
                    });
                    return;
                }

                Swal.fire({
                    title: 'Đang xử lý...',
                    text: 'Vui lòng đợi trong giây lát',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                // Đăng ký và tự động đăng nhập
                firebase.auth().createUserWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        const user = userCredential.user;
                        // Cập nhật tên người dùng
                        return user.updateProfile({
                            displayName: name
                        }).then(() => {
                            // Lưu thông tin người dùng vào Realtime Database
                            const userData = {
                                uid: user.uid,
                                email: user.email,
                                displayName: name,
                                photoURL: user.photoURL || 'https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/default-avatar.png',
                                lastLogin: new Date().toISOString(),
                                provider: 'password',
                                createdAt: new Date().toISOString()
                            };

                            // Lưu vào database
                            return firebase.database().ref('users/' + user.uid).set(userData)
                                .then(() => {
                                    // Tự động đăng nhập sau khi cập nhật profile
                                    return firebase.auth().signInWithEmailAndPassword(email, password);
                                });
                        });
                    })
                    .then(() => {
                        Swal.fire({
                            title: 'Thành công!',
                            text: 'Đăng ký và đăng nhập thành công',
                            icon: 'success',
                            timer: 1500,
                            showConfirmButton: false
                        });
                        modal.classList.remove('show');
                        updateLoginState(firebase.auth().currentUser);
                    })
                    .catch((error) => {
                        let errorMessage = 'Có lỗi xảy ra khi đăng ký';
                        
                        switch (error.code) {
                            case 'auth/email-already-in-use':
                                errorMessage = 'Email này đã được sử dụng. Vui lòng sử dụng email khác hoặc đăng nhập';
                                break;
                            case 'auth/invalid-email':
                                errorMessage = 'Email không hợp lệ';
                                break;
                            case 'auth/weak-password':
                                errorMessage = 'Mật khẩu quá yếu. Vui lòng sử dụng mật khẩu mạnh hơn';
                                break;
                            default:
                                errorMessage = error.message;
                        }

                        Swal.fire({
                            title: 'Lỗi!',
                            text: errorMessage,
                            icon: 'error'
                        });
                    });
            });

            document.getElementById('forgotPasswordForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('forgotEmail').value;

                if (!email) {
                    alert('Vui lòng nhập email của bạn');
                    return;
                }

                firebase.auth().sendPasswordResetEmail(email)
                    .then(() => {
                        alert('Link đặt lại mật khẩu đã được gửi đến email của bạn');
                        modal.classList.remove('show');
                    })
                    .catch((error) => {
                        console.error('Password reset error:', error);
                        alert('Gửi email thất bại: ' + error.message);
                    });
            });

            // Google Authentication with improved error handling
            const googleProvider = new firebase.auth.GoogleAuthProvider();
            googleProvider.setCustomParameters({
                prompt: 'select_account'
            });
            
            function handleGoogleAuth() {
                Swal.fire({
                    title: 'Đang xử lý...',
                    text: 'Vui lòng đợi trong giây lát',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                firebase.auth().signInWithPopup(googleProvider)
                    .then((result) => {
                        const user = result.user;
                        // Kiểm tra nếu là admin
                        if (user.email === 'quantrinutriplan@gmail.com') {
                            window.location.href = 'admin.html';
                            return;
                        }
                        // Kiểm tra xem người dùng đã tồn tại chưa
                        return firebase.database().ref('users/' + user.uid).once('value')
                            .then((snapshot) => {
                                if (!snapshot.exists()) {
                                    // Nếu chưa tồn tại, tạo mới thông tin người dùng
                                    const userData = {
                                        uid: user.uid,
                                        email: user.email,
                                        displayName: user.displayName,
                                        photoURL: user.photoURL,
                                        lastLogin: new Date().toISOString(),
                                        provider: 'google.com',
                                        createdAt: new Date().toISOString()
                                    };
                                    return firebase.database().ref('users/' + user.uid).set(userData);
                                } else {
                                    // Nếu đã tồn tại, chỉ cập nhật thời gian đăng nhập
                        return firebase.database().ref('users/' + user.uid).update({
                                        lastLogin: new Date().toISOString()
                                    });
                                }
                            })
                            .then(() => {
                                Swal.fire({
                                    title: 'Thành công!',
                                    text: 'Đăng nhập thành công',
                                    icon: 'success',
                                    timer: 1500,
                                    showConfirmButton: false
                                });
                                modal.classList.remove('show');
                                updateLoginState(user);
                            });
                    })
                    .catch((error) => {
                        let errorMessage = 'Có lỗi xảy ra khi đăng nhập';
                        
                        switch (error.code) {
                            case 'auth/popup-closed-by-user':
                                errorMessage = 'Đăng nhập bị hủy. Vui lòng thử lại';
                                break;
                            case 'auth/popup-blocked':
                                errorMessage = 'Trình duyệt đã chặn cửa sổ popup. Vui lòng cho phép popup và thử lại';
                                break;
                            case 'auth/cancelled-popup-request':
                                errorMessage = 'Đăng nhập bị hủy. Vui lòng thử lại';
                                break;
                            default:
                                errorMessage = error.message;
                        }

                        Swal.fire({
                            title: 'Lỗi!',
                            text: errorMessage,
                            icon: 'error'
                        });
                    });
            }

            document.getElementById('googleLogin').addEventListener('click', handleGoogleAuth);
            document.getElementById('googleRegister').addEventListener('click', handleGoogleAuth);

            // Function to update UI based on login state
            function updateLoginState(user) {
                const loginBtn = document.getElementById('loginBtn');
                if (user) {
                    let displayName;
                    
                    // Kiểm tra provider để hiển thị tên phù hợp
                    if (user.providerData && user.providerData[0]) {
                        const provider = user.providerData[0].providerId;
                        if (provider === 'password') {
                            // Nếu đăng nhập bằng email/password, ưu tiên hiển thị email
                            displayName = user.email.split('@')[0];
                        } else {
                            // Nếu đăng nhập bằng Google, ưu tiên hiển thị displayName
                            displayName = user.displayName || user.email.split('@')[0];
                        }
                    } else {
                        displayName = user.displayName || user.email.split('@')[0] || 'Tài khoản';
                    }
                    
                    // Format tên hiển thị tối đa 5 ký tự
                    const formattedName = displayName.length > 5 ? displayName.substring(0, 5) + '...' : displayName;
                    
                    // Get avatar from database with priority for custom avatar
                    firebase.database().ref('users/' + user.uid).once('value')
                        .then((snapshot) => {
                            const userData = snapshot.val();
                            let avatarSrc;
                            
                            // Priority: Custom avatar > Google Auth avatar > Default avatar
                            if (userData?.photoURL && !userData.photoURL.includes('default-avatar')) {
                                // User has custom avatar
                                avatarSrc = userData.photoURL;
                            } else if (user.photoURL && !user.photoURL.includes('default-avatar')) {
                                // Use Google Auth avatar
                                avatarSrc = user.photoURL;
                            } else {
                                // Fallback to default avatar
                                avatarSrc = 'https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/default-avatar.png';
                            }
                            
                            loginBtn.innerHTML = `
                                <img src="${avatarSrc}" alt="Avatar" class="user-avatar">
                                <span>${formattedName}</span>
                            `;
                        })
                        .catch(() => {
                            // Fallback to Google Auth avatar or default
                            const photoURL = user.photoURL || 'https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/default-avatar.png';
                            loginBtn.innerHTML = `
                                <img src="${photoURL}" alt="Avatar" class="user-avatar">
                                <span>${formattedName}</span>
                            `;
                        });
                    
                    loginBtn.href = '#';

                    // Only update basic info, don't override custom photoURL
                    const userData = {
                        uid: user.uid,
                        email: user.email,
                        displayName: user.displayName || displayName,
                        lastLogin: new Date().toISOString(),
                        provider: user.providerData[0]?.providerId || 'unknown'
                    };

                    // Check if user already has custom photoURL before updating
                    firebase.database().ref('users/' + user.uid).once('value')
                        .then((snapshot) => {
                            const existingData = snapshot.val();
                            // Only set photoURL if user doesn't have custom avatar
                            if (!existingData || !existingData.photoURL || existingData.photoURL.includes('default-avatar')) {
                                userData.photoURL = user.photoURL || 'https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/default-avatar.png';
                            }
                            return firebase.database().ref('users/' + user.uid).update(userData);
                        })
                        .then(() => {
                            console.log('User data saved successfully');
                        })
                        .catch((error) => {
                            console.error('Error saving user data:', error);
                        });
                } else {
                    loginBtn.innerHTML = 'Đăng Nhập';
                    loginBtn.href = '#';
                }
            }

            // Listen for auth state changes
            firebase.auth().onAuthStateChanged(function(user) {
                updateLoginState(user);
                // Close modal if user logs in
                if (user) {
                    modal.classList.remove('show');
                }
            });

            // Logout functionality
            const logoutBtn = document.getElementById('logoutBtn');
            logoutBtn.addEventListener('click', function(e) {
                e.preventDefault();
                Swal.fire({
                    title: 'Đăng xuất?',
                    text: "Bạn có chắc chắn muốn đăng xuất?",
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Đăng xuất',
                    cancelButtonText: 'Hủy'
                }).then((result) => {
                    if (result.isConfirmed) {
                        firebase.auth().signOut().then(() => {
                            Swal.fire({
                                title: 'Đã đăng xuất!',
                                text: 'Bạn đã đăng xuất thành công.',
                                icon: 'success',
                                timer: 1500,
                                showConfirmButton: false
                            }).then(() => {
                                window.location.href = 'auth.html';
                            });
                        }).catch((error) => {
                            Swal.fire({
                                title: 'Lỗi!',
                                text: 'Có lỗi xảy ra khi đăng xuất.',
                                icon: 'error'
                            });
                        });
                    }
                });
            });

            new Swiper('.recipes-slider', {
                slidesPerView: 3,
                spaceBetween: 24,
                loop: true,
                centeredSlides: false,
                autoplay: {
                    delay: 3500,
                    disableOnInteraction: false,
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                breakpoints: {
                    320: {
                        slidesPerView: 1.1,
                        spaceBetween: 10
                    },
                    600: {
                        slidesPerView: 1.5,
                        spaceBetween: 16
                    },
                    900: {
                        slidesPerView: 2,
                        spaceBetween: 20
                    },
                    1200: {
                        slidesPerView: 3,
                        spaceBetween: 24
                    }
                }
            });
        });

        function scrollRecipes(direction) {
            const container = document.querySelector('.recipes-grid');
            const scrollAmount = 300;
            if (direction === 'left') {
                container.scrollBy({
                    left: -scrollAmount,
                    behavior: 'smooth'
                });
            } else {
                container.scrollBy({
                    left: scrollAmount,
                    behavior: 'smooth'
                });
            }
        }

        // Thêm vào phần script hiện có
        document.addEventListener('DOMContentLoaded', function() {
            // Animation cho section
            const recipesSection = document.querySelector('.recipes-section');
            const recipeCards = document.querySelectorAll('.recipe-card');
            
            // Hàm kiểm tra element có trong viewport không
            function isInViewport(element) {
                const rect = element.getBoundingClientRect();
                return (
                    rect.top <= (window.innerHeight || document.documentElement.clientHeight) &&
                    rect.bottom >= 0
                );
            }

            // Hàm xử lý animation khi scroll
            function handleScrollAnimation() {
                if (isInViewport(recipesSection)) {
                    recipesSection.classList.add('visible');
                    
                    // Animation cho từng card
                    recipeCards.forEach((card, index) => {
                        setTimeout(() => {
                            card.classList.add('visible');
                        }, index * 200); // Delay 200ms cho mỗi card
                    });
                }
            }

            // Lắng nghe sự kiện scroll
            window.addEventListener('scroll', handleScrollAnimation);
            // Kiểm tra ngay khi load trang
            handleScrollAnimation();

            // Xử lý nút scroll
            const scrollLeftBtn = document.querySelector('.scroll-btn:first-child');
            const scrollRightBtn = document.querySelector('.scroll-btn:last-child');
            const recipesGrid = document.querySelector('.recipes-grid');

            scrollLeftBtn.addEventListener('click', () => {
                recipesGrid.scrollBy({
                    left: -300,
                    behavior: 'smooth'
                });
            });

            scrollRightBtn.addEventListener('click', () => {
                recipesGrid.scrollBy({
                    left: 300,
                    behavior: 'smooth'
                });
            });
        });

        // Add this to your existing Firebase initialization code
        function loadRecipes() {
            const recipesRef = firebase.database().ref('recipes');
            recipesRef.on('value', (snapshot) => {
                const recipesContainer = document.getElementById('recipesContainer');
                recipesContainer.innerHTML = ''; // Clear existing content
                
                snapshot.forEach((childSnapshot) => {
                    const recipe = childSnapshot.val();
                    const recipeElement = createRecipeCard(recipe);
                    recipesContainer.appendChild(recipeElement);
                });

                // Reinitialize Swiper after adding new slides
                new Swiper('.recipes-slider', {
                    slidesPerView: 3,
                    spaceBetween: 24,
                    loop: true,
                    centeredSlides: false,
                    autoplay: {
                        delay: 3500,
                        disableOnInteraction: false,
                    },
                    pagination: {
                        el: '.swiper-pagination',
                        clickable: true,
                    },
                    navigation: {
                        nextEl: '.swiper-button-next',
                        prevEl: '.swiper-button-prev',
                    },
                    breakpoints: {
                        320: {
                            slidesPerView: 1.1,
                            spaceBetween: 10
                        },
                        600: {
                            slidesPerView: 1.5,
                            spaceBetween: 16
                        },
                        900: {
                            slidesPerView: 2,
                            spaceBetween: 20
                        },
                        1200: {
                            slidesPerView: 3,
                            spaceBetween: 24
                        }
                    }
                });
            });
        }

        function createRecipeCard(recipe) {
            const slide = document.createElement('div');
            slide.className = 'swiper-slide';
            
            slide.innerHTML = `
                <div class="recipe-card">
                    <img src="${recipe.imageUrl}" alt="${recipe.name}">
                    <div class="recipe-content">
                        <h3>${recipe.name}</h3>
                        <div class="recipe-info">
                            <span>${recipe.category}</span>
                            <span>${new Date(recipe.createdAt).toLocaleDateString()}</span>
                        </div>
                        <div class="recipe-nutrition">
                            <div class="nutrition-item">
                                <div class="nutrition-value">${recipe.nutrition.calories}</div>
                                <div class="nutrition-label">Calories</div>
                            </div>
                            <div class="nutrition-item">
                                <div class="nutrition-value">${recipe.nutrition.protein}g</div>
                                <div class="nutrition-label">Protein</div>
                            </div>
                            <div class="nutrition-item">
                                <div class="nutrition-value">${recipe.nutrition.carbs}g</div>
                                <div class="nutrition-label">Carbs</div>
                            </div>
                        </div>
                        <p class="recipe-description">${recipe.description}</p>
                        <a href="FoodandRecipes.html?id=${recipe.id}" class="recipe-link">Xem Công Thức</a>
                    </div>
                </div>
            `;
            
            return slide;
        }

        // Call loadRecipes when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadRecipes();
        });
    </script>
</body>
</html>
